pre_install() {
	mkdir -p /usr/share/rpikernelhack/overlays
	mkdir -p /boot/overlays
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/bcm2708-rpi-0-w.dtb /boot/bcm2708-rpi-0-w.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/bcm2708-rpi-b-plus.dtb /boot/bcm2708-rpi-b-plus.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/bcm2708-rpi-b.dtb /boot/bcm2708-rpi-b.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/bcm2708-rpi-cm.dtb /boot/bcm2708-rpi-cm.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/bcm2709-rpi-2-b.dtb /boot/bcm2709-rpi-2-b.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/bcm2710-rpi-3-b-plus.dtb /boot/bcm2710-rpi-3-b-plus.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/bcm2710-rpi-3-b.dtb /boot/bcm2710-rpi-3-b.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/bcm2710-rpi-cm3.dtb /boot/bcm2710-rpi-cm3.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/kernel*.img /boot/kernel*.img
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/COPYING.linux /boot/COPYING.linux
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/35-hat.dtbo /boot/overlays/35-hat.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/3dlab-nano-player.dtbo /boot/overlays/3dlab-nano-player.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/4dpi-32.dtbo /boot/overlays/4dpi-32.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/README /boot/overlays/README
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/adau1977-adc.dtbo /boot/overlays/adau1977-adc.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/adau7002-simple.dtbo /boot/overlays/adau7002-simple.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/ads1015.dtbo /boot/overlays/ads1015.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/ads1115.dtbo /boot/overlays/ads1115.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/ads7846.dtbo /boot/overlays/ads7846.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/adv7282m.dtbo /boot/overlays/adv7282m.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/adv728x-m.dtbo /boot/overlays/adv728x-m.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/akkordion-iqdacplus.dtbo /boot/overlays/akkordion-iqdacplus.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/allo-boss-dac-pcm512x-audio.dtbo /boot/overlays/allo-boss-dac-pcm512x-audio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/allo-digione.dtbo /boot/overlays/allo-digione.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/allo-katana-dac-audio.dtbo /boot/overlays/allo-katana-dac-audio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/allo-piano-dac-pcm512x-audio.dtbo /boot/overlays/allo-piano-dac-pcm512x-audio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/allo-piano-dac-plus-pcm512x-audio.dtbo /boot/overlays/allo-piano-dac-plus-pcm512x-audio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/applepi-dac.dtbo /boot/overlays/applepi-dac.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/at86rf233.dtbo /boot/overlays/at86rf233.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/audioinjector-addons.dtbo /boot/overlays/audioinjector-addons.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/audioinjector-ultra.dtbo /boot/overlays/audioinjector-ultra.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/audioinjector-wm8731-audio.dtbo /boot/overlays/audioinjector-wm8731-audio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/audremap.dtbo /boot/overlays/audremap.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/balena-fin.dtbo /boot/overlays/balena-fin.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/bmp085_i2c-sensor.dtbo /boot/overlays/bmp085_i2c-sensor.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/dht11.dtbo /boot/overlays/dht11.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/dionaudio-loco-v2.dtbo /boot/overlays/dionaudio-loco-v2.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/dionaudio-loco.dtbo /boot/overlays/dionaudio-loco.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/dpi18.dtbo /boot/overlays/dpi18.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/dpi24.dtbo /boot/overlays/dpi24.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/dwc-otg.dtbo /boot/overlays/dwc-otg.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/dwc2.dtbo /boot/overlays/dwc2.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/elecfreaks22-overlay.dtb /boot/overlays/elecfreaks22-overlay.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/elecfreaks22.dtbo /boot/overlays/elecfreaks22.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/enc28j60-spi2.dtbo /boot/overlays/enc28j60-spi2.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/enc28j60.dtbo /boot/overlays/enc28j60.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/exc3000.dtbo /boot/overlays/exc3000.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/fe-pi-audio.dtbo /boot/overlays/fe-pi-audio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/goodix.dtbo /boot/overlays/goodix.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/googlevoicehat-soundcard.dtbo /boot/overlays/googlevoicehat-soundcard.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/gpio-fan.dtbo /boot/overlays/gpio-fan.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/gpio-ir-tx.dtbo /boot/overlays/gpio-ir-tx.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/gpio-ir.dtbo /boot/overlays/gpio-ir.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/gpio-key.dtbo /boot/overlays/gpio-key.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/gpio-no-bank0-irq.dtbo /boot/overlays/gpio-no-bank0-irq.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/gpio-no-irq.dtbo /boot/overlays/gpio-no-irq.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/gpio-poweroff.dtbo /boot/overlays/gpio-poweroff.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/gpio-shutdown.dtbo /boot/overlays/gpio-shutdown.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hd44780-lcd.dtbo /boot/overlays/hd44780-lcd.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hifiberry-amp.dtbo /boot/overlays/hifiberry-amp.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hifiberry-dac.dtbo /boot/overlays/hifiberry-dac.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hifiberry-dacplus.dtbo /boot/overlays/hifiberry-dacplus.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hifiberry-digi-pro.dtbo /boot/overlays/hifiberry-digi-pro.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hifiberry-digi.dtbo /boot/overlays/hifiberry-digi.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hy28a.dtbo /boot/overlays/hy28a.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hy28b-2017.dtbo /boot/overlays/hy28b-2017.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hy28b.dtbo /boot/overlays/hy28b.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hyperpixel-gpio-backlight.dtbo /boot/overlays/hyperpixel-gpio-backlight.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hyperpixel.dtbo /boot/overlays/hyperpixel.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hyperpixel4-touch.dtbo /boot/overlays/hyperpixel4-touch.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/hyperpixel4.dtbo /boot/overlays/hyperpixel4.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/i2c-bcm2708.dtbo /boot/overlays/i2c-bcm2708.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/i2c-gpio.dtbo /boot/overlays/i2c-gpio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/i2c-mux.dtbo /boot/overlays/i2c-mux.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/i2c-pwm-pca9685a.dtbo /boot/overlays/i2c-pwm-pca9685a.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/i2c-rtc-gpio.dtbo /boot/overlays/i2c-rtc-gpio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/i2c-rtc.dtbo /boot/overlays/i2c-rtc.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/i2c-sensor.dtbo /boot/overlays/i2c-sensor.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/i2c0-bcm2708.dtbo /boot/overlays/i2c0-bcm2708.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/i2c1-bcm2708.dtbo /boot/overlays/i2c1-bcm2708.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/i2s-gpio28-31.dtbo /boot/overlays/i2s-gpio28-31.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/iqaudio-dac.dtbo /boot/overlays/iqaudio-dac.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/iqaudio-dacplus.dtbo /boot/overlays/iqaudio-dacplus.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/iqaudio-digi-wm8804-audio.dtbo /boot/overlays/iqaudio-digi-wm8804-audio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/jbtek-overlay.dtb /boot/overlays/jbtek-overlay.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/jbtek.dtbo /boot/overlays/jbtek.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/jedec-spi-nor.dtbo /boot/overlays/jedec-spi-nor.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/justboom-dac.dtbo /boot/overlays/justboom-dac.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/justboom-digi.dtbo /boot/overlays/justboom-digi.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/lirc-rpi.dtbo /boot/overlays/lirc-rpi.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/ltc294x.dtbo /boot/overlays/ltc294x.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/mbed-dac.dtbo /boot/overlays/mbed-dac.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/mcp23017.dtbo /boot/overlays/mcp23017.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/mcp23s17.dtbo /boot/overlays/mcp23s17.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/mcp2515-can0.dtbo /boot/overlays/mcp2515-can0.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/mcp2515-can1.dtbo /boot/overlays/mcp2515-can1.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/mcp3008.dtbo /boot/overlays/mcp3008.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/mcp3202.dtbo /boot/overlays/mcp3202.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/media-center.dtbo /boot/overlays/media-center.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/midi-uart0.dtbo /boot/overlays/midi-uart0.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/midi-uart1.dtbo /boot/overlays/midi-uart1.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/mmc.dtbo /boot/overlays/mmc.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/mpu6050.dtbo /boot/overlays/mpu6050.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/mz61581.dtbo /boot/overlays/mz61581.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/ov5647.dtbo /boot/overlays/ov5647.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/papirus.dtbo /boot/overlays/papirus.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pi3-act-led.dtbo /boot/overlays/pi3-act-led.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pi3-disable-bt.dtbo /boot/overlays/pi3-disable-bt.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pi3-disable-wifi.dtbo /boot/overlays/pi3-disable-wifi.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pi3-miniuart-bt.dtbo /boot/overlays/pi3-miniuart-bt.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pibell.dtbo /boot/overlays/pibell.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/piscreen.dtbo /boot/overlays/piscreen.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/piscreen2r.dtbo /boot/overlays/piscreen2r.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pisound.dtbo /boot/overlays/pisound.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pitft22.dtbo /boot/overlays/pitft22.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pitft28-capacitive.dtbo /boot/overlays/pitft28-capacitive.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pitft28-resistive.dtbo /boot/overlays/pitft28-resistive.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pitft35-resistive.dtbo /boot/overlays/pitft35-resistive.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pps-gpio.dtbo /boot/overlays/pps-gpio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pwm-2chan.dtbo /boot/overlays/pwm-2chan.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pwm-ir-tx.dtbo /boot/overlays/pwm-ir-tx.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/pwm.dtbo /boot/overlays/pwm.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/qca7000.dtbo /boot/overlays/qca7000.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/rotary-encoder.dtbo /boot/overlays/rotary-encoder.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/rpi-backlight.dtbo /boot/overlays/rpi-backlight.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/rpi-cirrus-wm5102.dtbo /boot/overlays/rpi-cirrus-wm5102.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/rpi-dac.dtbo /boot/overlays/rpi-dac.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/rpi-display.dtbo /boot/overlays/rpi-display.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/rpi-ft5406.dtbo /boot/overlays/rpi-ft5406.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/rpi-poe.dtbo /boot/overlays/rpi-poe.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/rpi-proto.dtbo /boot/overlays/rpi-proto.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/rpi-sense.dtbo /boot/overlays/rpi-sense.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/rpi-tv.dtbo /boot/overlays/rpi-tv.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/rra-digidac1-wm8741-audio.dtbo /boot/overlays/rra-digidac1-wm8741-audio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/sainsmart32-overlay.dtb /boot/overlays/sainsmart32-overlay.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/sainsmart32.dtbo /boot/overlays/sainsmart32.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/sc16is750-i2c.dtbo /boot/overlays/sc16is750-i2c.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/sc16is752-i2c.dtbo /boot/overlays/sc16is752-i2c.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/sc16is752-spi1.dtbo /boot/overlays/sc16is752-spi1.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/sdhost.dtbo /boot/overlays/sdhost.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/sdio-1bit.dtbo /boot/overlays/sdio-1bit.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/sdio.dtbo /boot/overlays/sdio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/sdtweak.dtbo /boot/overlays/sdtweak.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/smi-dev.dtbo /boot/overlays/smi-dev.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/smi-nand.dtbo /boot/overlays/smi-nand.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/smi.dtbo /boot/overlays/smi.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/spi-gpio35-39.dtbo /boot/overlays/spi-gpio35-39.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/spi-rtc.dtbo /boot/overlays/spi-rtc.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/spi0-cs.dtbo /boot/overlays/spi0-cs.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/spi0-hw-cs.dtbo /boot/overlays/spi0-hw-cs.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/spi1-1cs.dtbo /boot/overlays/spi1-1cs.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/spi1-2cs.dtbo /boot/overlays/spi1-2cs.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/spi1-3cs.dtbo /boot/overlays/spi1-3cs.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/spi2-1cs.dtbo /boot/overlays/spi2-1cs.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/spi2-2cs.dtbo /boot/overlays/spi2-2cs.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/spi2-3cs.dtbo /boot/overlays/spi2-3cs.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/superaudioboard.dtbo /boot/overlays/superaudioboard.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/sx150x.dtbo /boot/overlays/sx150x.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/tc358743-audio.dtbo /boot/overlays/tc358743-audio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/tc358743.dtbo /boot/overlays/tc358743.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/tinylcd35.dtbo /boot/overlays/tinylcd35.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/tpm-slb9670.dtbo /boot/overlays/tpm-slb9670.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/uart0.dtbo /boot/overlays/uart0.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/uart1.dtbo /boot/overlays/uart1.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/upstream-aux-interrupt.dtbo /boot/overlays/upstream-aux-interrupt.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/upstream.dtbo /boot/overlays/upstream.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/vc4-fkms-v3d.dtbo /boot/overlays/vc4-fkms-v3d.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/vc4-kms-kippah-7inch.dtbo /boot/overlays/vc4-kms-kippah-7inch.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/vc4-kms-v3d.dtbo /boot/overlays/vc4-kms-v3d.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/vga666.dtbo /boot/overlays/vga666.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/w1-gpio-pullup.dtbo /boot/overlays/w1-gpio-pullup.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/w1-gpio.dtbo /boot/overlays/w1-gpio.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/waveshare32b-overlay.dtb /boot/overlays/waveshare32b-overlay.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/waveshare32b.dtbo /boot/overlays/waveshare32b.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/waveshare35a-overlay.dtb /boot/overlays/waveshare35a-overlay.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/waveshare35a.dtbo /boot/overlays/waveshare35a.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/waveshare35b-overlay.dtb /boot/overlays/waveshare35b-overlay.dtb
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/waveshare35b.dtbo /boot/overlays/waveshare35b.dtbo
	dpkg-divert --package rpikernelhack --divert /usr/share/rpikernelhack/overlays/wittypi.dtbo /boot/overlays/wittypi.dtbo
	if [ -f /etc/default/kalipi-kernel ]; then
	  . /etc/default/kalipi-kernel
	  INITRD=${INITRD:-"No"}
	  export INITRD
	  RPI_INITRD=${RPI_INITRD:-"No"}
	  export RPI_INITRD
	fi
	fi
	fi
	fi
	fi

}

post_install() {
	if [ -f /usr/share/rpikernelhack/bcm2708-rpi-0-w.dtb ]; then
		rm -f /boot/bcm2708-rpi-0-w.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/bcm2708-rpi-0-w.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/bcm2708-rpi-b-plus.dtb ]; then
		rm -f /boot/bcm2708-rpi-b-plus.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/bcm2708-rpi-b-plus.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/bcm2708-rpi-b.dtb ]; then
		rm -f /boot/bcm2708-rpi-b.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/bcm2708-rpi-b.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/bcm2708-rpi-cm.dtb ]; then
		rm -f /boot/bcm2708-rpi-cm.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/bcm2708-rpi-cm.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/bcm2709-rpi-2-b.dtb ]; then
		rm -f /boot/bcm2709-rpi-2-b.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/bcm2709-rpi-2-b.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/bcm2710-rpi-3-b-plus.dtb ]; then
		rm -f /boot/bcm2710-rpi-3-b-plus.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/bcm2710-rpi-3-b-plus.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/bcm2710-rpi-3-b.dtb ]; then
		rm -f /boot/bcm2710-rpi-3-b.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/bcm2710-rpi-3-b.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/bcm2710-rpi-cm3.dtb ]; then
		rm -f /boot/bcm2710-rpi-cm3.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/bcm2710-rpi-cm3.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/kernel*.img ]; then
		rm -f /boot/kernel*.img
		dpkg-divert --package rpikernelhack --remove --rename /boot/kernel*.img
		sync
	fi
	if [ -f /usr/share/rpikernelhack/COPYING.linux ]; then
		rm -f /boot/COPYING.linux
		dpkg-divert --package rpikernelhack --remove --rename /boot/COPYING.linux
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/35-hat.dtbo ]; then
		rm -f /boot/overlays/35-hat.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/35-hat.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/3dlab-nano-player.dtbo ]; then
		rm -f /boot/overlays/3dlab-nano-player.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/3dlab-nano-player.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/4dpi-32.dtbo ]; then
		rm -f /boot/overlays/4dpi-32.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/4dpi-32.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/README ]; then
		rm -f /boot/overlays/README
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/README
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/adau1977-adc.dtbo ]; then
		rm -f /boot/overlays/adau1977-adc.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/adau1977-adc.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/adau7002-simple.dtbo ]; then
		rm -f /boot/overlays/adau7002-simple.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/adau7002-simple.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/ads1015.dtbo ]; then
		rm -f /boot/overlays/ads1015.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/ads1015.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/ads1115.dtbo ]; then
		rm -f /boot/overlays/ads1115.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/ads1115.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/ads7846.dtbo ]; then
		rm -f /boot/overlays/ads7846.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/ads7846.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/adv7282m.dtbo ]; then
		rm -f /boot/overlays/adv7282m.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/adv7282m.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/adv728x-m.dtbo ]; then
		rm -f /boot/overlays/adv728x-m.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/adv728x-m.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/akkordion-iqdacplus.dtbo ]; then
		rm -f /boot/overlays/akkordion-iqdacplus.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/akkordion-iqdacplus.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/allo-boss-dac-pcm512x-audio.dtbo ]; then
		rm -f /boot/overlays/allo-boss-dac-pcm512x-audio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/allo-boss-dac-pcm512x-audio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/allo-digione.dtbo ]; then
		rm -f /boot/overlays/allo-digione.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/allo-digione.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/allo-katana-dac-audio.dtbo ]; then
		rm -f /boot/overlays/allo-katana-dac-audio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/allo-katana-dac-audio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/allo-piano-dac-pcm512x-audio.dtbo ]; then
		rm -f /boot/overlays/allo-piano-dac-pcm512x-audio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/allo-piano-dac-pcm512x-audio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/allo-piano-dac-plus-pcm512x-audio.dtbo ]; then
		rm -f /boot/overlays/allo-piano-dac-plus-pcm512x-audio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/allo-piano-dac-plus-pcm512x-audio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/applepi-dac.dtbo ]; then
		rm -f /boot/overlays/applepi-dac.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/applepi-dac.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/at86rf233.dtbo ]; then
		rm -f /boot/overlays/at86rf233.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/at86rf233.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/audioinjector-addons.dtbo ]; then
		rm -f /boot/overlays/audioinjector-addons.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/audioinjector-addons.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/audioinjector-ultra.dtbo ]; then
		rm -f /boot/overlays/audioinjector-ultra.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/audioinjector-ultra.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/audioinjector-wm8731-audio.dtbo ]; then
		rm -f /boot/overlays/audioinjector-wm8731-audio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/audioinjector-wm8731-audio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/audremap.dtbo ]; then
		rm -f /boot/overlays/audremap.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/audremap.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/balena-fin.dtbo ]; then
		rm -f /boot/overlays/balena-fin.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/balena-fin.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/bmp085_i2c-sensor.dtbo ]; then
		rm -f /boot/overlays/bmp085_i2c-sensor.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/bmp085_i2c-sensor.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/dht11.dtbo ]; then
		rm -f /boot/overlays/dht11.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/dht11.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/dionaudio-loco-v2.dtbo ]; then
		rm -f /boot/overlays/dionaudio-loco-v2.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/dionaudio-loco-v2.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/dionaudio-loco.dtbo ]; then
		rm -f /boot/overlays/dionaudio-loco.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/dionaudio-loco.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/dpi18.dtbo ]; then
		rm -f /boot/overlays/dpi18.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/dpi18.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/dpi24.dtbo ]; then
		rm -f /boot/overlays/dpi24.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/dpi24.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/dwc-otg.dtbo ]; then
		rm -f /boot/overlays/dwc-otg.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/dwc-otg.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/dwc2.dtbo ]; then
		rm -f /boot/overlays/dwc2.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/dwc2.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/elecfreaks22-overlay.dtb ]; then
		rm -f /boot/overlays/elecfreaks22-overlay.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/elecfreaks22-overlay.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/elecfreaks22.dtbo ]; then
		rm -f /boot/overlays/elecfreaks22.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/elecfreaks22.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/enc28j60-spi2.dtbo ]; then
		rm -f /boot/overlays/enc28j60-spi2.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/enc28j60-spi2.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/enc28j60.dtbo ]; then
		rm -f /boot/overlays/enc28j60.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/enc28j60.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/exc3000.dtbo ]; then
		rm -f /boot/overlays/exc3000.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/exc3000.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/fe-pi-audio.dtbo ]; then
		rm -f /boot/overlays/fe-pi-audio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/fe-pi-audio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/goodix.dtbo ]; then
		rm -f /boot/overlays/goodix.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/goodix.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/googlevoicehat-soundcard.dtbo ]; then
		rm -f /boot/overlays/googlevoicehat-soundcard.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/googlevoicehat-soundcard.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/gpio-fan.dtbo ]; then
		rm -f /boot/overlays/gpio-fan.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/gpio-fan.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/gpio-ir-tx.dtbo ]; then
		rm -f /boot/overlays/gpio-ir-tx.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/gpio-ir-tx.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/gpio-ir.dtbo ]; then
		rm -f /boot/overlays/gpio-ir.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/gpio-ir.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/gpio-key.dtbo ]; then
		rm -f /boot/overlays/gpio-key.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/gpio-key.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/gpio-no-bank0-irq.dtbo ]; then
		rm -f /boot/overlays/gpio-no-bank0-irq.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/gpio-no-bank0-irq.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/gpio-no-irq.dtbo ]; then
		rm -f /boot/overlays/gpio-no-irq.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/gpio-no-irq.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/gpio-poweroff.dtbo ]; then
		rm -f /boot/overlays/gpio-poweroff.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/gpio-poweroff.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/gpio-shutdown.dtbo ]; then
		rm -f /boot/overlays/gpio-shutdown.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/gpio-shutdown.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hd44780-lcd.dtbo ]; then
		rm -f /boot/overlays/hd44780-lcd.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hd44780-lcd.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hifiberry-amp.dtbo ]; then
		rm -f /boot/overlays/hifiberry-amp.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hifiberry-amp.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hifiberry-dac.dtbo ]; then
		rm -f /boot/overlays/hifiberry-dac.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hifiberry-dac.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hifiberry-dacplus.dtbo ]; then
		rm -f /boot/overlays/hifiberry-dacplus.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hifiberry-dacplus.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hifiberry-digi-pro.dtbo ]; then
		rm -f /boot/overlays/hifiberry-digi-pro.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hifiberry-digi-pro.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hifiberry-digi.dtbo ]; then
		rm -f /boot/overlays/hifiberry-digi.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hifiberry-digi.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hy28a.dtbo ]; then
		rm -f /boot/overlays/hy28a.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hy28a.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hy28b-2017.dtbo ]; then
		rm -f /boot/overlays/hy28b-2017.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hy28b-2017.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hy28b.dtbo ]; then
		rm -f /boot/overlays/hy28b.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hy28b.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hyperpixel-gpio-backlight.dtbo ]; then
		rm -f /boot/overlays/hyperpixel-gpio-backlight.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hyperpixel-gpio-backlight.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hyperpixel.dtbo ]; then
		rm -f /boot/overlays/hyperpixel.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hyperpixel.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hyperpixel4-touch.dtbo ]; then
		rm -f /boot/overlays/hyperpixel4-touch.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hyperpixel4-touch.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/hyperpixel4.dtbo ]; then
		rm -f /boot/overlays/hyperpixel4.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/hyperpixel4.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/i2c-bcm2708.dtbo ]; then
		rm -f /boot/overlays/i2c-bcm2708.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/i2c-bcm2708.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/i2c-gpio.dtbo ]; then
		rm -f /boot/overlays/i2c-gpio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/i2c-gpio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/i2c-mux.dtbo ]; then
		rm -f /boot/overlays/i2c-mux.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/i2c-mux.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/i2c-pwm-pca9685a.dtbo ]; then
		rm -f /boot/overlays/i2c-pwm-pca9685a.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/i2c-pwm-pca9685a.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/i2c-rtc-gpio.dtbo ]; then
		rm -f /boot/overlays/i2c-rtc-gpio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/i2c-rtc-gpio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/i2c-rtc.dtbo ]; then
		rm -f /boot/overlays/i2c-rtc.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/i2c-rtc.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/i2c-sensor.dtbo ]; then
		rm -f /boot/overlays/i2c-sensor.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/i2c-sensor.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/i2c0-bcm2708.dtbo ]; then
		rm -f /boot/overlays/i2c0-bcm2708.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/i2c0-bcm2708.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/i2c1-bcm2708.dtbo ]; then
		rm -f /boot/overlays/i2c1-bcm2708.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/i2c1-bcm2708.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/i2s-gpio28-31.dtbo ]; then
		rm -f /boot/overlays/i2s-gpio28-31.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/i2s-gpio28-31.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/iqaudio-dac.dtbo ]; then
		rm -f /boot/overlays/iqaudio-dac.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/iqaudio-dac.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/iqaudio-dacplus.dtbo ]; then
		rm -f /boot/overlays/iqaudio-dacplus.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/iqaudio-dacplus.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/iqaudio-digi-wm8804-audio.dtbo ]; then
		rm -f /boot/overlays/iqaudio-digi-wm8804-audio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/iqaudio-digi-wm8804-audio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/jbtek-overlay.dtb ]; then
		rm -f /boot/overlays/jbtek-overlay.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/jbtek-overlay.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/jbtek.dtbo ]; then
		rm -f /boot/overlays/jbtek.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/jbtek.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/jedec-spi-nor.dtbo ]; then
		rm -f /boot/overlays/jedec-spi-nor.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/jedec-spi-nor.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/justboom-dac.dtbo ]; then
		rm -f /boot/overlays/justboom-dac.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/justboom-dac.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/justboom-digi.dtbo ]; then
		rm -f /boot/overlays/justboom-digi.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/justboom-digi.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/lirc-rpi.dtbo ]; then
		rm -f /boot/overlays/lirc-rpi.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/lirc-rpi.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/ltc294x.dtbo ]; then
		rm -f /boot/overlays/ltc294x.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/ltc294x.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/mbed-dac.dtbo ]; then
		rm -f /boot/overlays/mbed-dac.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/mbed-dac.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/mcp23017.dtbo ]; then
		rm -f /boot/overlays/mcp23017.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/mcp23017.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/mcp23s17.dtbo ]; then
		rm -f /boot/overlays/mcp23s17.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/mcp23s17.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/mcp2515-can0.dtbo ]; then
		rm -f /boot/overlays/mcp2515-can0.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/mcp2515-can0.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/mcp2515-can1.dtbo ]; then
		rm -f /boot/overlays/mcp2515-can1.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/mcp2515-can1.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/mcp3008.dtbo ]; then
		rm -f /boot/overlays/mcp3008.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/mcp3008.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/mcp3202.dtbo ]; then
		rm -f /boot/overlays/mcp3202.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/mcp3202.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/media-center.dtbo ]; then
		rm -f /boot/overlays/media-center.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/media-center.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/midi-uart0.dtbo ]; then
		rm -f /boot/overlays/midi-uart0.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/midi-uart0.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/midi-uart1.dtbo ]; then
		rm -f /boot/overlays/midi-uart1.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/midi-uart1.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/mmc.dtbo ]; then
		rm -f /boot/overlays/mmc.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/mmc.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/mpu6050.dtbo ]; then
		rm -f /boot/overlays/mpu6050.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/mpu6050.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/mz61581.dtbo ]; then
		rm -f /boot/overlays/mz61581.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/mz61581.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/ov5647.dtbo ]; then
		rm -f /boot/overlays/ov5647.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/ov5647.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/papirus.dtbo ]; then
		rm -f /boot/overlays/papirus.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/papirus.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pi3-act-led.dtbo ]; then
		rm -f /boot/overlays/pi3-act-led.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pi3-act-led.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pi3-disable-bt.dtbo ]; then
		rm -f /boot/overlays/pi3-disable-bt.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pi3-disable-bt.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pi3-disable-wifi.dtbo ]; then
		rm -f /boot/overlays/pi3-disable-wifi.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pi3-disable-wifi.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pi3-miniuart-bt.dtbo ]; then
		rm -f /boot/overlays/pi3-miniuart-bt.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pi3-miniuart-bt.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pibell.dtbo ]; then
		rm -f /boot/overlays/pibell.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pibell.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/piscreen.dtbo ]; then
		rm -f /boot/overlays/piscreen.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/piscreen.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/piscreen2r.dtbo ]; then
		rm -f /boot/overlays/piscreen2r.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/piscreen2r.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pisound.dtbo ]; then
		rm -f /boot/overlays/pisound.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pisound.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pitft22.dtbo ]; then
		rm -f /boot/overlays/pitft22.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pitft22.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pitft28-capacitive.dtbo ]; then
		rm -f /boot/overlays/pitft28-capacitive.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pitft28-capacitive.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pitft28-resistive.dtbo ]; then
		rm -f /boot/overlays/pitft28-resistive.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pitft28-resistive.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pitft35-resistive.dtbo ]; then
		rm -f /boot/overlays/pitft35-resistive.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pitft35-resistive.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pps-gpio.dtbo ]; then
		rm -f /boot/overlays/pps-gpio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pps-gpio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pwm-2chan.dtbo ]; then
		rm -f /boot/overlays/pwm-2chan.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pwm-2chan.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pwm-ir-tx.dtbo ]; then
		rm -f /boot/overlays/pwm-ir-tx.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pwm-ir-tx.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/pwm.dtbo ]; then
		rm -f /boot/overlays/pwm.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/pwm.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/qca7000.dtbo ]; then
		rm -f /boot/overlays/qca7000.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/qca7000.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/rotary-encoder.dtbo ]; then
		rm -f /boot/overlays/rotary-encoder.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/rotary-encoder.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/rpi-backlight.dtbo ]; then
		rm -f /boot/overlays/rpi-backlight.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/rpi-backlight.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/rpi-cirrus-wm5102.dtbo ]; then
		rm -f /boot/overlays/rpi-cirrus-wm5102.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/rpi-cirrus-wm5102.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/rpi-dac.dtbo ]; then
		rm -f /boot/overlays/rpi-dac.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/rpi-dac.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/rpi-display.dtbo ]; then
		rm -f /boot/overlays/rpi-display.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/rpi-display.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/rpi-ft5406.dtbo ]; then
		rm -f /boot/overlays/rpi-ft5406.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/rpi-ft5406.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/rpi-poe.dtbo ]; then
		rm -f /boot/overlays/rpi-poe.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/rpi-poe.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/rpi-proto.dtbo ]; then
		rm -f /boot/overlays/rpi-proto.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/rpi-proto.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/rpi-sense.dtbo ]; then
		rm -f /boot/overlays/rpi-sense.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/rpi-sense.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/rpi-tv.dtbo ]; then
		rm -f /boot/overlays/rpi-tv.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/rpi-tv.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/rra-digidac1-wm8741-audio.dtbo ]; then
		rm -f /boot/overlays/rra-digidac1-wm8741-audio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/rra-digidac1-wm8741-audio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/sainsmart32-overlay.dtb ]; then
		rm -f /boot/overlays/sainsmart32-overlay.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/sainsmart32-overlay.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/sainsmart32.dtbo ]; then
		rm -f /boot/overlays/sainsmart32.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/sainsmart32.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/sc16is750-i2c.dtbo ]; then
		rm -f /boot/overlays/sc16is750-i2c.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/sc16is750-i2c.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/sc16is752-i2c.dtbo ]; then
		rm -f /boot/overlays/sc16is752-i2c.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/sc16is752-i2c.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/sc16is752-spi1.dtbo ]; then
		rm -f /boot/overlays/sc16is752-spi1.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/sc16is752-spi1.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/sdhost.dtbo ]; then
		rm -f /boot/overlays/sdhost.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/sdhost.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/sdio-1bit.dtbo ]; then
		rm -f /boot/overlays/sdio-1bit.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/sdio-1bit.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/sdio.dtbo ]; then
		rm -f /boot/overlays/sdio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/sdio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/sdtweak.dtbo ]; then
		rm -f /boot/overlays/sdtweak.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/sdtweak.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/smi-dev.dtbo ]; then
		rm -f /boot/overlays/smi-dev.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/smi-dev.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/smi-nand.dtbo ]; then
		rm -f /boot/overlays/smi-nand.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/smi-nand.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/smi.dtbo ]; then
		rm -f /boot/overlays/smi.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/smi.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/spi-gpio35-39.dtbo ]; then
		rm -f /boot/overlays/spi-gpio35-39.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/spi-gpio35-39.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/spi-rtc.dtbo ]; then
		rm -f /boot/overlays/spi-rtc.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/spi-rtc.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/spi0-cs.dtbo ]; then
		rm -f /boot/overlays/spi0-cs.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/spi0-cs.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/spi0-hw-cs.dtbo ]; then
		rm -f /boot/overlays/spi0-hw-cs.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/spi0-hw-cs.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/spi1-1cs.dtbo ]; then
		rm -f /boot/overlays/spi1-1cs.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/spi1-1cs.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/spi1-2cs.dtbo ]; then
		rm -f /boot/overlays/spi1-2cs.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/spi1-2cs.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/spi1-3cs.dtbo ]; then
		rm -f /boot/overlays/spi1-3cs.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/spi1-3cs.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/spi2-1cs.dtbo ]; then
		rm -f /boot/overlays/spi2-1cs.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/spi2-1cs.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/spi2-2cs.dtbo ]; then
		rm -f /boot/overlays/spi2-2cs.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/spi2-2cs.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/spi2-3cs.dtbo ]; then
		rm -f /boot/overlays/spi2-3cs.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/spi2-3cs.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/superaudioboard.dtbo ]; then
		rm -f /boot/overlays/superaudioboard.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/superaudioboard.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/sx150x.dtbo ]; then
		rm -f /boot/overlays/sx150x.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/sx150x.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/tc358743-audio.dtbo ]; then
		rm -f /boot/overlays/tc358743-audio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/tc358743-audio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/tc358743.dtbo ]; then
		rm -f /boot/overlays/tc358743.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/tc358743.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/tinylcd35.dtbo ]; then
		rm -f /boot/overlays/tinylcd35.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/tinylcd35.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/tpm-slb9670.dtbo ]; then
		rm -f /boot/overlays/tpm-slb9670.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/tpm-slb9670.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/uart0.dtbo ]; then
		rm -f /boot/overlays/uart0.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/uart0.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/uart1.dtbo ]; then
		rm -f /boot/overlays/uart1.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/uart1.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/upstream-aux-interrupt.dtbo ]; then
		rm -f /boot/overlays/upstream-aux-interrupt.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/upstream-aux-interrupt.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/upstream.dtbo ]; then
		rm -f /boot/overlays/upstream.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/upstream.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/vc4-fkms-v3d.dtbo ]; then
		rm -f /boot/overlays/vc4-fkms-v3d.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/vc4-fkms-v3d.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/vc4-kms-kippah-7inch.dtbo ]; then
		rm -f /boot/overlays/vc4-kms-kippah-7inch.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/vc4-kms-kippah-7inch.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/vc4-kms-v3d.dtbo ]; then
		rm -f /boot/overlays/vc4-kms-v3d.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/vc4-kms-v3d.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/vga666.dtbo ]; then
		rm -f /boot/overlays/vga666.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/vga666.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/w1-gpio-pullup.dtbo ]; then
		rm -f /boot/overlays/w1-gpio-pullup.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/w1-gpio-pullup.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/w1-gpio.dtbo ]; then
		rm -f /boot/overlays/w1-gpio.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/w1-gpio.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/waveshare32b-overlay.dtb ]; then
		rm -f /boot/overlays/waveshare32b-overlay.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/waveshare32b-overlay.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/waveshare32b.dtbo ]; then
		rm -f /boot/overlays/waveshare32b.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/waveshare32b.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/waveshare35a-overlay.dtb ]; then
		rm -f /boot/overlays/waveshare35a-overlay.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/waveshare35a-overlay.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/waveshare35a.dtbo ]; then
		rm -f /boot/overlays/waveshare35a.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/waveshare35a.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/waveshare35b-overlay.dtb ]; then
		rm -f /boot/overlays/waveshare35b-overlay.dtb
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/waveshare35b-overlay.dtb
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/waveshare35b.dtbo ]; then
		rm -f /boot/overlays/waveshare35b.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/waveshare35b.dtbo
		sync
	fi
	if [ -f /usr/share/rpikernelhack/overlays/wittypi.dtbo ]; then
		rm -f /boot/overlays/wittypi.dtbo
		dpkg-divert --package rpikernelhack --remove --rename /boot/overlays/wittypi.dtbo
		sync
	fi
	if [ -f /etc/default/kalipi-kernel ]; then
	  . /etc/default/kalipi-kernel
	  INITRD=${INITRD:-"No"}
	  export INITRD
	  RPI_INITRD=${RPI_INITRD:-"No"}
	  export RPI_INITRD

	fi
	fi
	fi
	fi
	fi
		if [ -e /boot/System.map-4.19.15-Re4son+ ]; then
			depmod -a -F /boot/System.map-4.19.15-Re4son+ 4.19.15-Re4son+ || true
		fi
	fi
		if [ -e /boot/System.map-4.19.15-Re4son-v7+ ]; then
			depmod -a -F /boot/System.map-4.19.15-Re4son-v7+ 4.19.15-Re4son-v7+ || true
		fi
	fi
		if [ -e /boot/System.map-4.19.15-Re4son-v8+ ]; then
			depmod -a -F /boot/System.map-4.19.15-Re4son-v8+ 4.19.15-Re4son-v8+ || true
		fi
	fi

}

pre_upgrade() {
	pre_install
}

post_upgrade() {
	post_install
}

pre_remove() {
	if [ -f /etc/default/kalipi-kernel ]; then
	  . /etc/default/kalipi-kernel
	  INITRD=${INITRD:-"No"}
	  export INITRD
	  RPI_INITRD=${RPI_INITRD:-"No"}
	  export RPI_INITRD

	fi
	fi
	fi
	fi
	fi

}

post_remove() {
	if [ -f /etc/default/kalipi-kernel ]; then
	  . /etc/default/kalipi-kernel
	  INITRD=${INITRD:-"No"}
	  export INITRD
	  RPI_INITRD=${RPI_INITRD:-"No"}
	  export RPI_INITRD

	fi
	fi
	fi
	fi
	fi
	if [ -e /boot/System.map-4.19.15-Re4son-v8+ ]; then
		depmod -a -F /boot/System.map-4.19.15-Re4son-v8+ 4.19.15-Re4son-v8+ || true
	fi
	if [ -e /boot/System.map-4.19.15-Re4son-v7+ ]; then
		depmod -a -F /boot/System.map-4.19.15-Re4son-v7+ 4.19.15-Re4son-v7+ || true
	fi
	if [ -e /boot/System.map-4.19.15-Re4son+ ]; then
		depmod -a -F /boot/System.map-4.19.15-Re4son+ 4.19.15-Re4son+ || true
	fi

}
